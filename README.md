# üõ∞Ô∏è THEOS AI - Land Cover & Object Segmentation
## ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏õ‡∏Å‡∏Ñ‡∏•‡∏∏‡∏°‡∏î‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏û‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° THEOS

---

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö Deep Learning ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:
1. **Semantic Segmentation** (‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏õ‡∏Å‡∏Ñ‡∏•‡∏∏‡∏°‡∏î‡∏¥‡∏ô) - ‡∏î‡πâ‡∏ß‡∏¢ DeepLabV3+, UNet, HRNet
2. **Object Detection/Instance Segmentation** (‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏) - ‡∏î‡πâ‡∏ß‡∏¢ YOLOv8

### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° THEOS
- ‡∏Ç‡∏ô‡∏≤‡∏î: 10,933 x 10,086 ‡∏û‡∏¥‡∏Å‡πÄ‡∏ã‡∏•
- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô bands: 4 (Red, Green, Blue, NIR) - UInt16
- ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏¥‡∏Å‡∏±‡∏î: WGS 84 (EPSG:4326)
- ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°: NDVI, Normalized

### Classes (7 ‡∏Ñ‡∏•‡∏≤‡∏™)

| Index | Class | ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢ | ‡∏™‡∏µ (RGB) | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏û |
|:-----:|-------|---------|:--------:|--------------|
| 0 | `background` | ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á / ‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö | ‚¨õ `[0,0,0]` | ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡πÑ‡∏î‡πâ, ‡∏Ç‡∏≠‡∏ö‡∏†‡∏≤‡∏û |
| 1 | `vegetation` | ‡∏û‡∏∑‡∏ä‡∏û‡∏£‡∏£‡∏ì | üü© `[0,255,0]` | ‡∏õ‡πà‡∏≤, ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ, ‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ |
| 2 | `water` | ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ô‡πâ‡∏≥ | üü¶ `[0,0,255]` | ‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥, ‡∏Ñ‡∏•‡∏≠‡∏á, ‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥, ‡∏≠‡πà‡∏≤‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏ô‡πâ‡∏≥ |
| 3 | `urban` | ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏∑‡∏≠‡∏á | üü• `[255,0,0]` | ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£, ‡∏™‡∏¥‡πà‡∏á‡∏õ‡∏•‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á, ‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô |
| 4 | `agriculture` | ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏£‡∏° | üü® `[255,255,0]` | ‡∏ô‡∏≤‡∏Ç‡πâ‡∏≤‡∏ß, ‡πÑ‡∏£‡πà, ‡πÅ‡∏õ‡∏•‡∏á‡∏ú‡∏±‡∏Å |
| 5 | `bare_soil` | ‡∏î‡∏¥‡∏ô‡πÄ‡∏õ‡∏•‡πà‡∏≤ | üü´ `[139,69,19]` | ‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡πÇ‡∏•‡πà‡∏á, ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á |
| 6 | `road` | ‡∏ñ‡∏ô‡∏ô | ‚¨ú `[128,128,128]` | ‡∏ñ‡∏ô‡∏ô, ‡∏ó‡∏≤‡∏á‡∏´‡∏•‡∏ß‡∏á, ‡∏ó‡∏≤‡∏á‡∏•‡∏≤‡∏î‡∏¢‡∏≤‡∏á |

> **‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:** ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô class ‡πÉ‡∏î ‡πÉ‡∏´‡πâ label ‡πÄ‡∏õ‡πá‡∏ô `background` (0) ‚Äî ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏±‡πâ‡∏á `ignore_index=0` ‡πÉ‡∏ô loss function ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ

---

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå

```
theos_ai/
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îî‚îÄ‚îÄ config.yaml          # ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (classes, hyperparameters ‡∏Ø‡∏•‡∏Ø)
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ tiles/                # ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô tiles (512x512)
‚îÇ   ‚îú‚îÄ‚îÄ labels/               # label masks ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö segmentation
‚îÇ   ‚îî‚îÄ‚îÄ yolo_labels/          # labels ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö YOLO (.txt)
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ deeplabv3.py          # ‡πÇ‡∏°‡πÄ‡∏î‡∏• DeepLabV3+
‚îÇ   ‚îú‚îÄ‚îÄ unet.py               # ‡πÇ‡∏°‡πÄ‡∏î‡∏• UNet / UNet++
‚îÇ   ‚îú‚îÄ‚îÄ hrnet.py              # ‡πÇ‡∏°‡πÄ‡∏î‡∏• HRNet
‚îÇ   ‚îî‚îÄ‚îÄ yolo_model.py         # ‡πÇ‡∏°‡πÄ‡∏î‡∏• YOLOv8 (detection + segmentation)
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ prepare_tiles.py      # ‡∏ï‡∏±‡∏î‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡πá‡∏ô tiles
‚îÇ   ‚îú‚îÄ‚îÄ create_labels.py      # ‡∏™‡∏£‡πâ‡∏≤‡∏á labels ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô (K-Means)
‚îÇ   ‚îú‚îÄ‚îÄ train_segmentation.py # ‡πÄ‡∏ó‡∏£‡∏ô DeepLabV3/UNet/HRNet
‚îÇ   ‚îú‚îÄ‚îÄ train_yolo.py         # ‡πÄ‡∏ó‡∏£‡∏ô YOLO
‚îÇ   ‚îî‚îÄ‚îÄ predict.py            # ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ (inference) ‡∏ó‡∏±‡πâ‡∏á‡∏†‡∏≤‡∏û
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ dataset.py            # Dataset & DataLoader
‚îÇ   ‚îú‚îÄ‚îÄ losses.py             # Loss functions (Dice, Focal, Combined)
‚îÇ   ‚îî‚îÄ‚îÄ metrics.py            # Metrics (mIoU, OA, Kappa, F1)
‚îú‚îÄ‚îÄ results/                  # ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (models, predictions, logs)
‚îú‚îÄ‚îÄ theos/                    # ‡∏†‡∏≤‡∏û‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏°‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö
‚îú‚îÄ‚îÄ requirements.txt          # dependencies
‚îî‚îÄ‚îÄ README.md                 # ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ
```

---

## üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Step-by-Step)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 0: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies

```bash
# ‡∏™‡∏£‡πâ‡∏≤‡∏á virtual environment ‡∏î‡πâ‡∏ß‡∏¢ conda
conda create -n theos_ai python=3.9 -y
conda activate theos_ai

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á packages
pip install -r requirements.txt
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏±‡∏î‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡πá‡∏ô Tiles

‡∏†‡∏≤‡∏û‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏°‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà (10,933 x 10,086) ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô tiles ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡∏£‡∏ô:

```bash
python scripts/prepare_tiles.py --config configs/config.yaml
```

‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô:
- ‡∏ï‡∏±‡∏î‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡πá‡∏ô tiles ‡∏Ç‡∏ô‡∏≤‡∏î 512x512 ‡∏û‡∏¥‡∏Å‡πÄ‡∏ã‡∏•
- ‡∏Å‡∏£‡∏≠‡∏á tiles ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô nodata ‡∏≠‡∏≠‡∏Å
- ‡πÅ‡∏ö‡πà‡∏á train/val/test (70/15/15%)
- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å metadata (‡∏û‡∏¥‡∏Å‡∏±‡∏î, bounding box)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Labels

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á pseudo-labels ‡∏î‡πâ‡∏ß‡∏¢ K-Means (‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)**
```bash
python scripts/create_labels.py --config configs/config.yaml
```
> ‚ö†Ô∏è K-Means ‡πÉ‡∏´‡πâ‡∏ú‡∏•‡πÅ‡∏Ñ‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£ ‡∏ï‡πâ‡∏≠‡∏á refine ‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Annotation ‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠ (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)**

‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ annotation:
| ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ | ‡∏•‡∏¥‡∏á‡∏Å‡πå | ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ |
|-----------|------|------|
| QGIS | https://qgis.org | ‚úÖ ‡∏ü‡∏£‡∏µ, ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö GeoTIFF, ‡∏°‡∏µ plugin ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö annotation |
| Label Studio | https://labelstud.io | ‚úÖ ‡∏ü‡∏£‡∏µ, web-based, ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö segmentation |
| CVAT | https://cvat.ai | ‚úÖ ‡∏ü‡∏£‡∏µ, ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö polygon/mask annotation |
| Roboflow | https://roboflow.com | ‚úÖ ‡∏ü‡∏£‡∏µ tier, ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö YOLO format |

**‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Semantic Segmentation:**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á mask ‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏û‡∏¥‡∏Å‡πÄ‡∏ã‡∏•‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô class index (0-6)
- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô PNG grayscale ‡πÉ‡∏ô `data/labels/`

> üí° **‡∏à‡∏≥‡∏ô‡∏ß‡∏ô mask/label ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡∏ï‡πà‡∏≠ class):**
>
> | ‡∏£‡∏∞‡∏î‡∏±‡∏ö | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô tiles ‡∏ó‡∏µ‡πà label | ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á |
> |-------|----------------------|-------------------|
> | ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ | 50‚Äì100 | ‡∏û‡∏≠‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö prototype |
> | ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ | 200‚Äì500 | ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏î‡∏µ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö production ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô |
> | ‡∏î‡∏µ‡∏°‡∏≤‡∏Å | 500‚Äì1,000+ | ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö production ‡∏à‡∏£‡∏¥‡∏á |
>
> - ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏°‡∏µ 7 classes ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ label ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ **350‚Äì3,500 tiles** (50‚Äì500 ‡∏ï‡πà‡∏≠ class)
> - ‡πÅ‡∏ï‡πà‡∏•‡∏∞ class ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô label ‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Å‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤ class imbalance
> - class ‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ô‡πâ‡∏≠‡∏¢ (‡πÄ‡∏ä‡πà‡∏ô water, road) ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡πâ‡∏ß‡∏¢ data augmentation

**‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö YOLO Object Detection:**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á bounding box labels ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö YOLO:
  ```
  class_id center_x center_y width height
  ```
- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô .txt ‡πÉ‡∏ô `data/yolo_labels/`

> üí° **‡∏à‡∏≥‡∏ô‡∏ß‡∏ô bounding box label ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡∏ï‡πà‡∏≠ class):**
>
> | ‡∏£‡∏∞‡∏î‡∏±‡∏ö | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô annotations ‡∏ï‡πà‡∏≠ class | ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á |
> |-------|----------------------------|-------------------|
> | ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ | 100‚Äì200 | ‡∏û‡∏≠‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö |
> | ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ | 500‚Äì1,000 | ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏î‡∏µ |
> | ‡∏î‡∏µ‡∏°‡∏≤‡∏Å | 1,500‚Äì3,000+ | ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á |
>
> - YOLOv8 ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ label ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ segmentation ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏
> - ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ object ‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏°‡∏∏‡∏°‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ class

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•

#### 3.1 Semantic Segmentation (DeepLabV3+ / UNet / HRNet)

```bash
# ‡πÄ‡∏ó‡∏£‡∏ô DeepLabV3+
python scripts/train_segmentation.py --model deeplabv3

# ‡πÄ‡∏ó‡∏£‡∏ô UNet
python scripts/train_segmentation.py --model unet

# ‡πÄ‡∏ó‡∏£‡∏ô UNet++
python scripts/train_segmentation.py --model unetpp

# ‡πÄ‡∏ó‡∏£‡∏ô HRNet
python scripts/train_segmentation.py --model hrnet

# ‡∏õ‡∏£‡∏±‡∏ö hyperparameters
python scripts/train_segmentation.py --model deeplabv3 --epochs 200 --batch-size 4 --lr 0.0001
```

#### 3.2 YOLO Object Detection/Segmentation

```bash
# ‡πÄ‡∏ó‡∏£‡∏ô YOLO
python scripts/train_yolo.py --config configs/config.yaml

# ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•
python scripts/train_yolo.py --model yolov8s-seg  # ‡πÄ‡∏•‡πá‡∏Å, ‡πÄ‡∏£‡πá‡∏ß
python scripts/train_yolo.py --model yolov8m-seg  # ‡∏Å‡∏•‡∏≤‡∏á (default)
python scripts/train_yolo.py --model yolov8l-seg  # ‡πÉ‡∏´‡∏ç‡πà, ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
python scripts/train_yolo.py --model yolov8x-seg  # ‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏∏‡∏î
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ (Inference)

```bash
# ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ DeepLabV3+
python scripts/predict.py --model deeplabv3 --input theos/theos_4326.tif

# ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ UNet
python scripts/predict.py --model unet --input theos/theos_4326.tif

# ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ HRNet
python scripts/predict.py --model hrnet --input theos/theos_4326.tif
```

‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:
- `results/{model}_prediction.tif` - GeoTIFF ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ class index
- `results/{model}_prediction_color.png` - ‡∏†‡∏≤‡∏û‡∏™‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏ú‡∏•

---

## üèóÔ∏è ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•

### 1. DeepLabV3+ (Semantic Segmentation)
- **Encoder**: ResNet-101 (pretrained ImageNet)
- **‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô**: Atrous Spatial Pyramid Pooling (ASPP) - ‡∏à‡∏±‡∏ö context ‡∏´‡∏•‡∏≤‡∏¢ scale
- **‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö**: ‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏ß‡πâ‡∏≤‡∏á, land cover mapping ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
- **‡∏Ç‡πâ‡∏≠‡∏î‡∏µ**: ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö classes ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà

### 2. UNet (Semantic Segmentation)
- **Encoder**: ResNet-50 (pretrained ImageNet) + SCSE Attention
- **‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô**: Skip connections - ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï
- **‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö**: ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏õ‡∏•‡∏á‡∏ô‡∏≤, ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ô‡πâ‡∏≥
- **‡∏Ç‡πâ‡∏≠‡∏î‡∏µ**: ‡πÄ‡∏ó‡∏£‡∏ô‡πÄ‡∏£‡πá‡∏ß, ‡πÉ‡∏ä‡πâ memory ‡∏ô‡πâ‡∏≠‡∏¢

### 3. HRNet (Semantic Segmentation)
- **Encoder**: HRNet-W48 + FPN Decoder
- **‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô**: ‡∏£‡∏±‡∏Å‡∏©‡∏≤ high-resolution ‡∏ï‡∏•‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢
- **‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö**: ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏π‡∏á, ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô
- **‡∏Ç‡πâ‡∏≠‡∏î‡∏µ**: ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î, ‡∏î‡∏µ‡∏Å‡∏±‡∏ö small objects

### 4. YOLOv8-Seg (Object Detection + Instance Segmentation)
- **Architecture**: YOLOv8 Medium + Segmentation Head
- **‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô**: ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏¥‡πâ‡∏ô + polygon mask
- **‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö**: ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£, ‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞, ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ
- **‡∏Ç‡πâ‡∏≠‡∏î‡∏µ**: ‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å, real-time inference

---

## ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (config.yaml)

### Classes (‡∏™‡∏¥‡πà‡∏á‡∏õ‡∏Å‡∏Ñ‡∏•‡∏∏‡∏°‡∏î‡∏¥‡∏ô)
‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÉ‡∏ô `configs/config.yaml`:
```yaml
classes:
  - name: "background"       # ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
  - name: "vegetation"       # ‡∏û‡∏∑‡∏ä‡∏û‡∏£‡∏£‡∏ì
  - name: "water"            # ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ô‡πâ‡∏≥
  - name: "urban"            # ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏∑‡∏≠‡∏á
  - name: "agriculture"      # ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏£‡∏°
  - name: "bare_soil"        # ‡∏î‡∏¥‡∏ô‡πÄ‡∏õ‡∏•‡πà‡∏≤
  - name: "road"             # ‡∏ñ‡∏ô‡∏ô
```

### Hyperparameters ‡∏´‡∏•‡∏±‡∏Å
```yaml
segmentation:
  batch_size: 8          # ‡∏•‡∏î‡∏•‡∏á‡∏ñ‡πâ‡∏≤ GPU memory ‡πÑ‡∏°‡πà‡∏û‡∏≠
  learning_rate: 0.001   # ‡∏•‡∏≠‡∏á‡∏•‡∏î‡πÄ‡∏õ‡πá‡∏ô 0.0001 ‡∏ñ‡πâ‡∏≤ overfit
  epochs: 100            # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà converge
  loss: "combo"          # "ce", "dice", "focal", "combo"
```

---

## üìä Metrics ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•

| Metric | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ | ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏µ |
|--------|---------|---------|
| **mIoU** | Mean Intersection over Union - ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏£‡∏ß‡∏° | > 0.60 |
| **OA** | Overall Accuracy - ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏¥‡∏Å‡πÄ‡∏ã‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á | > 0.80 |
| **Kappa** | Cohen's Kappa - ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á | > 0.60 |
| **F1** | F1-Score ‡∏ï‡πà‡∏≠ class | > 0.70 |
| **mAP** | Mean Average Precision (YOLO) | > 0.50 |

---

## üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

### ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
1. **‡πÉ‡∏ä‡πâ NDVI** ‡πÄ‡∏õ‡πá‡∏ô input ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‚Üí ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏û‡∏∑‡∏ä‡∏û‡∏£‡∏£‡∏ì‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
2. **‡∏ó‡∏≥ normalization** ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡∏£‡∏ô (‡πÑ‡∏ü‡∏•‡πå `theos_norm_4326.tif`)
3. **‡πÄ‡∏û‡∏¥‡πà‡∏° augmentation** ‡πÄ‡∏ä‡πà‡∏ô flip, rotate, color jitter
4. **‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà** (spatial split) ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏ö‡∏ö random ‚Üí ‡∏•‡∏î data leakage

### ‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô
1. **‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏•‡πá‡∏Å** (UNet + ResNet34) ‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÑ‡∏õ‡πÉ‡∏´‡∏ç‡πà
2. **‡πÉ‡∏ä‡πâ pretrained weights** (ImageNet) ‡πÄ‡∏™‡∏°‡∏≠ ‚Üí converge ‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤
3. **‡∏•‡∏≠‡∏á Combined Loss** (CE + Dice) ‚Üí ‡∏î‡∏µ‡∏Å‡∏±‡∏ö class imbalance
4. **‡∏î‡∏π TensorBoard** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö overfitting: `tensorboard --logdir results/logs`

### Apple Silicon (M1/M2/M3)
```bash
# ‡πÉ‡∏ä‡πâ MPS backend
export PYTORCH_ENABLE_MPS_FALLBACK=1
```

### GPU (NVIDIA)
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö CUDA
python -c "import torch; print(torch.cuda.is_available())"
```

---

## üîó ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- [segmentation_models_pytorch](https://github.com/qubvel/segmentation_models_pytorch) - ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ segmentation
- [Ultralytics YOLOv8](https://docs.ultralytics.com/) - YOLO documentation
- [Albumentations](https://albumentations.ai/) - Data augmentation
- [Rasterio](https://rasterio.readthedocs.io/) - ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô GeoTIFF

---

*‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏° THEOS*
